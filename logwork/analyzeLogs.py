# Read and process a directory of log files generated by HyGen CMS.
#   Thanks to Herb Hainey for some source code contributions.

import os
import glob

verbose = True  # Switch dev print statements on and off
log_path = '/Users/billmarty/CMSlogs'

def main():

    # Go to the log directory and get a list of the 'run' log files.
    os.chdir(log_path)
    if verbose: print('Working dir: ' + str(os.getcwd()))
    run_files = glob.glob("*run*.csv")
    if verbose: print('There are ' + str(len(run_files)) + ' run log files.')
    run_files.sort()

    # File name template: year-month-day_hour_run#.csv
    # Get a list of the dates.
    date_list = []
    for file in run_files:
        if '_' in file:
            underscore = file.find('_')
            file_date = file[:underscore]
            if not file_date in date_list:
                date_list.append(file_date)
    if verbose:
        print(str(len(date_list)) + ' unique dates')
        print(date_list)


if __name__ == '__main__':
    main()
